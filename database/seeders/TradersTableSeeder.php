<?php

namespace Database\Seeders;

use App\Models\Trader;
use Cloudinary\Cloudinary;
use Illuminate\Database\Seeder;
use Illuminate\Support\Facades\File;

class TradersTableSeeder extends Seeder
{
    protected $cloudinary;

    public function __construct()
    {
        $this->cloudinary = new Cloudinary([
            'cloud' => [
                'cloud_name' => env('CLOUDINARY_CLOUD_NAME'),
                'api_key'    => env('CLOUDINARY_API_KEY'),
                'api_secret' => env('CLOUDINARY_API_SECRET'),
            ],
            'url' => [
                'secure' => true
            ]
        ]);
    }

    public function run()
    {


        $traders = [
            [
                'id' => 1,
                'picture' => 'uploads/photos/1750547967.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Kyle ChassÃ© / DD',
                'return_rate' => 96.28,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 5826,
                'profit_share' => 20.00,
                'created_at' => '2025-03-18 08:12:41',
                'updated_at' => '2025-06-22 03:19:27',
            ],
            [
                'id' => 2,
                'picture' => 'uploads/photos/1750549123.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'VirtualBacon',
                'return_rate' => 98.27,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 5246,
                'profit_share' => 20.00,
                'created_at' => '2025-04-07 07:04:31',
                'updated_at' => '2025-06-22 03:38:43',
            ],
            [
                'id' => 3,
                'picture' => 'uploads/photos/1750549155.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Dan Gambardello',
                'return_rate' => 97.28,
                'min_amount' => 3000.00,
                'max_amount' => 3000.00,
                'followers' => 4047,
                'profit_share' => 20.00,
                'created_at' => '2025-04-14 01:48:04',
                'updated_at' => '2025-06-22 03:39:15',
            ],
            [
                'id' => 4,
                'picture' => 'uploads/photos/1750549332.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'John @ The Rock Trading Co.',
                'return_rate' => 94.27,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 6890,
                'profit_share' => 20.00,
                'created_at' => '2025-04-14 01:51:34',
                'updated_at' => '2025-06-22 03:42:12',
            ],
            [
                'id' => 5,
                'picture' => 'uploads/photos/1750549372.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Ash Crypto',
                'return_rate' => 97.29,
                'min_amount' => 3000.00,
                'max_amount' => 3000.00,
                'followers' => 7054,
                'profit_share' => 20.00,
                'created_at' => '2025-04-16 15:42:42',
                'updated_at' => '2025-06-22 03:42:52',
            ],
            [
                'id' => 6,
                'picture' => 'uploads/photos/1750549388.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Banana3',
                'return_rate' => 97.24,
                'min_amount' => 5000.00,
                'max_amount' => 5000.00,
                'followers' => 5821,
                'profit_share' => 20.00,
                'created_at' => '2025-04-16 15:44:07',
                'updated_at' => '2025-06-22 03:43:08',
            ],
            [
                'id' => 7,
                'picture' => 'uploads/photos/1750549407.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'CrediBULL Crypto',
                'return_rate' => 98.25,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 5427,
                'profit_share' => 20.00,
                'created_at' => '2025-04-16 15:45:38',
                'updated_at' => '2025-06-22 03:43:27',
            ],
            [
                'id' => 8,
                'picture' => 'uploads/photos/1751371819.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Heisenberg',
                'return_rate' => 97.28,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 6702,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:00:23',
                'updated_at' => '2025-07-01 16:10:19',
            ],
            [
                'id' => 9,
                'picture' => 'uploads/photos/1750549497.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Nancy Pelosi Stock Tracker',
                'return_rate' => 96.27,
                'min_amount' => 5000.00,
                'max_amount' => 5000.00,
                'followers' => 7620,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:05:39',
                'updated_at' => '2025-06-22 03:44:57',
            ],
            [
                'id' => 10,
                'picture' => 'uploads/photos/1750549562.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Gordon',
                'return_rate' => 97.56,
                'min_amount' => 2000.00,
                'max_amount' => 2000.00,
                'followers' => 6803,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:07:59',
                'updated_at' => '2025-06-22 03:46:02',
            ],
            [
                'id' => 11,
                'picture' => 'uploads/photos/1750549624.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Lady of Crypto',
                'return_rate' => 94.29,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 4086,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:09:28',
                'updated_at' => '2025-06-22 03:47:04',
            ],
            [
                'id' => 12,
                'picture' => 'uploads/photos/1750550433.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Adam Mancini',
                'return_rate' => 95.26,
                'min_amount' => 3000.00,
                'max_amount' => 3000.00,
                'followers' => 5280,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:12:02',
                'updated_at' => '2025-06-22 04:00:33',
            ],
            [
                'id' => 13,
                'picture' => 'uploads/photos/1750550398.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Michael Saylor',
                'return_rate' => 98.23,
                'min_amount' => 5000.00,
                'max_amount' => 5000.00,
                'followers' => 7086,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:17:56',
                'updated_at' => '2025-06-22 03:59:58',
            ],
            [
                'id' => 14,
                'picture' => 'uploads/photos/1750550413.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Lin',
                'return_rate' => 94.23,
                'min_amount' => 2000.00,
                'max_amount' => 2000.00,
                'followers' => 4082,
                'profit_share' => 20.00,
                'created_at' => '2025-04-17 01:19:22',
                'updated_at' => '2025-06-22 04:00:13',
            ],
            [
                'id' => 15,
                'picture' => 'uploads/photos/1750550201.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'amit',
                'return_rate' => 96.29,
                'min_amount' => 2000.00,
                'max_amount' => 2000.00,
                'followers' => 5087,
                'profit_share' => 20.00,
                'created_at' => '2025-04-25 12:36:25',
                'updated_at' => '2025-06-22 03:56:41',
            ],
            [
                'id' => 16,
                'picture' => 'uploads/photos/1750550179.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Blockchainedbb',
                'return_rate' => 98.25,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 4802,
                'profit_share' => 20.00,
                'created_at' => '2025-04-26 05:51:25',
                'updated_at' => '2025-06-22 03:56:19',
            ],
            [
                'id' => 17,
                'picture' => 'uploads/photos/1750550162.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Ali',
                'return_rate' => 96.28,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 4089,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:25:49',
                'updated_at' => '2025-06-22 03:56:02',
            ],
            [
                'id' => 18,
                'picture' => 'uploads/photos/1750550138.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'BitQuant',
                'return_rate' => 96.25,
                'min_amount' => 2000.00,
                'max_amount' => 2000.00,
                'followers' => 5182,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:26:54',
                'updated_at' => '2025-06-22 03:55:38',
            ],
            [
                'id' => 19,
                'picture' => 'uploads/photos/1750550120.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'ionicXBT',
                'return_rate' => 94.36,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 4702,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:31:25',
                'updated_at' => '2025-06-22 03:55:20',
            ],
            [
                'id' => 20,
                'picture' => 'uploads/photos/1750550083.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Peter DiCarlo',
                'return_rate' => 97.28,
                'min_amount' => 3000.00,
                'max_amount' => 3000.00,
                'followers' => 3802,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:32:50',
                'updated_at' => '2025-06-22 03:54:43',
            ],
            [
                'id' => 21,
                'picture' => 'uploads/photos/1750550064.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'WOLF Trading',
                'return_rate' => 95.27,
                'min_amount' => 3000.00,
                'max_amount' => 3000.00,
                'followers' => 6085,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:35:06',
                'updated_at' => '2025-06-22 03:54:24',
            ],
            [
                'id' => 22,
                'picture' => 'uploads/photos/1750550042.jpeg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'CRG',
                'return_rate' => 96.28,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 3876,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:37:14',
                'updated_at' => '2025-06-22 03:54:02',
            ],
            [
                'id' => 23,
                'picture' => 'uploads/photos/1750550001.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'EliteOptionsTrader',
                'return_rate' => 96.29,
                'min_amount' => 2000.00,
                'max_amount' => 2000.00,
                'followers' => 5602,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:40:16',
                'updated_at' => '2025-06-22 03:53:21',
            ],
            [
                'id' => 24,
                'picture' => 'uploads/photos/1750549986.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'il Capo Of Crypto',
                'return_rate' => 98.25,
                'min_amount' => 3000.00,
                'max_amount' => 3000.00,
                'followers' => 7261,
                'profit_share' => 20.00,
                'created_at' => '2025-05-10 08:44:09',
                'updated_at' => '2025-06-22 03:53:06',
            ],
            [
                'id' => 25,
                'picture' => 'uploads/photos/1750549966.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Chris',
                'return_rate' => 97.05,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 4097,
                'profit_share' => 20.00,
                'created_at' => '2025-05-14 01:05:00',
                'updated_at' => '2025-06-22 03:52:46',
            ],
            [
                'id' => 26,
                'picture' => 'uploads/photos/1750549944.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Jake Claver, QFOP',
                'return_rate' => 97.54,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 5082,
                'profit_share' => 20.00,
                'created_at' => '2025-05-21 02:05:14',
                'updated_at' => '2025-06-22 03:52:24',
            ],
            [
                'id' => 27,
                'picture' => 'uploads/photos/1751832921.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Doctor Profit ğŸ‡¨ğŸ‡­',
                'return_rate' => 94.56,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 8031,
                'profit_share' => 20.00,
                'created_at' => '2025-05-21 02:13:46',
                'updated_at' => '2025-07-07 00:15:21',
            ],
            [
                'id' => 28,
                'picture' => 'uploads/photos/1750549921.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Daniel',
                'return_rate' => 95.26,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 3725,
                'profit_share' => 20.00,
                'created_at' => '2025-05-21 02:15:56',
                'updated_at' => '2025-06-22 03:52:01',
            ],
            [
                'id' => 29,
                'picture' => 'uploads/photos/1750549901.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Arthur Hayes',
                'return_rate' => 96.64,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 6027,
                'profit_share' => 20.00,
                'created_at' => '2025-05-21 16:23:46',
                'updated_at' => '2025-06-22 03:51:41',
            ],
            [
                'id' => 30,
                'picture' => 'uploads/photos/1750549852.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'The Long Investor',
                'return_rate' => 97.21,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 6035,
                'profit_share' => 20.00,
                'created_at' => '2025-05-21 18:53:53',
                'updated_at' => '2025-06-22 03:50:52',
            ],
            [
                'id' => 31,
                'picture' => 'uploads/photos/1751727888.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'BALE',
                'return_rate' => 96.48,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 6072,
                'profit_share' => 20.00,
                'created_at' => '2025-05-27 04:28:43',
                'updated_at' => '2025-07-05 19:04:48',
            ],
            [
                'id' => 32,
                'picture' => 'uploads/photos/1750549812.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'TW - The Wealthy Trader',
                'return_rate' => 95.48,
                'min_amount' => 1000.00,
                'max_amount' => 1000.00,
                'followers' => 5172,
                'profit_share' => 20.00,
                'created_at' => '2025-05-27 04:28:43',
                'updated_at' => '2025-06-22 03:50:12',
            ],
            [
                'id' => 33,
                'picture' => 'uploads/photos/1750549789.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Titan of Crypto',
                'return_rate' => 97.43,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 5087,
                'profit_share' => 20.00,
                'created_at' => '2025-05-28 13:24:38',
                'updated_at' => '2025-06-22 03:49:49',
            ],
            [
                'id' => 34,
                'picture' => 'uploads/photos/1750549769.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Master WU',
                'return_rate' => 97.48,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 8062,
                'profit_share' => 20.00,
                'created_at' => '2025-06-02 20:06:51',
                'updated_at' => '2025-06-22 03:49:29',
            ],
            [
                'id' => 35,
                'picture' => 'uploads/photos/1750549752.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'The House Of Crypto',
                'return_rate' => 96.62,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 7145,
                'profit_share' => 20.00,
                'created_at' => '2025-06-04 23:26:05',
                'updated_at' => '2025-06-22 03:49:12',
            ],
            [
                'id' => 36,
                'picture' => 'uploads/photos/1750549731.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Remz',
                'return_rate' => 95.47,
                'min_amount' => 1.00,
                'max_amount' => 1.00,
                'followers' => 4089,
                'profit_share' => 20.00,
                'created_at' => '2025-06-05 01:56:57',
                'updated_at' => '2025-06-22 03:48:51',
            ],
            [
                'id' => 38,
                'picture' => 'uploads/photos/1750549646.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Mike investing',
                'return_rate' => 94.57,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 5082,
                'profit_share' => 20.00,
                'created_at' => '2025-06-11 04:52:12',
                'updated_at' => '2025-06-22 03:47:26',
            ],
            [
                'id' => 39,
                'picture' => 'uploads/photos/1750921511.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'ancient warrior',
                'return_rate' => 94.36,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 4702,
                'profit_share' => 20.00,
                'created_at' => '2025-06-26 11:05:11',
                'updated_at' => '2025-06-26 11:05:11',
            ],
            [
                'id' => 41,
                'picture' => 'uploads/photos/1751728142.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'MMCrypto',
                'return_rate' => 95.68,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 6704,
                'profit_share' => 20.00,
                'created_at' => '2025-07-05 19:09:02',
                'updated_at' => '2025-07-05 19:09:02',
            ],
            [
                'id' => 42,
                'picture' => 'uploads/photos/1751728230.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'PlanB',
                'return_rate' => 97.59,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 8143,
                'profit_share' => 20.00,
                'created_at' => '2025-07-05 19:10:30',
                'updated_at' => '2025-07-05 19:10:30',
            ],
            [
                'id' => 43,
                'picture' => 'uploads/photos/1751833512.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Coach Mak | Know Your Money',
                'return_rate' => 97.38,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 5087,
                'profit_share' => 20.00,
                'created_at' => '2025-07-07 00:25:12',
                'updated_at' => '2025-07-07 00:25:12',
            ],
            [
                'id' => 44,
                'picture' => 'uploads/photos/1751835285.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'Sjuul | AltCryptoGems',
                'return_rate' => 94.67,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 6702,
                'profit_share' => 20.00,
                'created_at' => '2025-07-07 00:54:45',
                'updated_at' => '2025-07-07 00:54:45',
            ],
            [
                'id' => 45,
                'picture' => 'uploads/photos/1751896762.jpg',
                'is_verified' => 1,
                'verified_badge' => null,
                'name' => 'KilliaXBT',
                'return_rate' => 95.37,
                'min_amount' => 3000.00,
                'max_amount' => 5000.00,
                'followers' => 4031,
                'profit_share' => 20.00,
                'created_at' => '2025-07-07 17:59:22',
                'updated_at' => '2025-07-07 17:59:22',
            ],
        ];

        foreach ($traders as $traderData) {
            $pictureData = null;

            // If picture path is provided, upload to Cloudinary
            if (!empty($traderData['picture'])) {
                $picturePath = public_path($traderData['picture']);

                if (File::exists($picturePath)) {
                    $pictureData = $this->uploadToCloudinary($picturePath, 'traders');
                } else {
                    $this->command->warn("Image not found: {$traderData['picture']}");
                }
            }

            // Create the trader record with explicit ID
            Trader::create([
                'id' => $traderData['id'],
                'picture_url' => $pictureData['secure_url'] ?? null,
                'picture_public_id' => $pictureData['public_id'] ?? null,
                'is_verified' => $traderData['is_verified'],
                'verified_badge' => $traderData['verified_badge'],
                'name' => $traderData['name'],
                'return_rate' => $traderData['return_rate'],
                'min_amount' => $traderData['min_amount'],
                'max_amount' => $traderData['max_amount'],
                'followers' => $traderData['followers'],
                'profit_share' => $traderData['profit_share'],
                'created_at' => $traderData['created_at'],
                'updated_at' => $traderData['updated_at'],
            ]);
        }
    }

    protected function uploadToCloudinary($imagePath, $folder)
    {
        try {
            $uploadResult = $this->cloudinary->uploadApi()->upload($imagePath, [
                'folder' => $folder,
                'transformation' => [
                    'width' => 500,
                    'height' => 500,
                    'crop' => 'fill',
                    'quality' => 'auto',
                    'gravity' => 'face',
                ]
            ]);

            return [
                'public_id' => $uploadResult['public_id'],
                'secure_url' => $uploadResult['secure_url'],
            ];
        } catch (\Exception $e) {
            $this->command->error("Failed to upload image: {$e->getMessage()}");
            return null;
        }
    }
}
